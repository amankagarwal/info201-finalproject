shiny::runApp('Desktop/Assignments/info201-finalproject')
library("dplyr")
library("snakecase")
library("plotly")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# Use a user-defined function to get a dataframe which has all player names by role
#
#
# blue.mid <- data.frame(league.data$blueMiddle) %>%
#   select(mid = league.data.blueMiddle)
# red.mid <- data.frame(league.data$redMiddle) %>%
#   select(mid = league.data.redMiddle)
# Issue, these player names are all lowercase (had to do that otherwise unique() would not filter out everything)
# Should I titleCase() everything?
# mid.players <- unique(rbind(blue.mid, red.mid)) # a dataframe with one column, mid, which has all midlaners's name (for search bar)
# returns a dataframe which has all players by role, and their winrates at both the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
# Testing the winrate.by.role function for Mid lane ->
function()
winrates.top <- winrateRole("Top")
winrates.jungle <- winrateRole("Jungle")
winrates.mid <- winrateRole("Middle")
winrates.adc <- winrateRole("ADC")
winrates.support <- winrateRole("Support")
# Plot a stacked bar chart (dont differentiate between blue and red)
winrates <- c()
runApp('Desktop/Assignments/info201-finalproject')
install.packages("snakecase")
install.packages("snakecase")
library("shiny")
library("shinythemes")
source("scripts/win-rate-comparison.R")
shinyUI <- fluidPage(title = "League Analysis", theme = shinytheme("spacelab"),
mainPanel(
navbarPage(strong("League of Legends"),
tabPanel("Overview"),
tabPanel("Player Win Rates",
sidebarLayout(
sidebarPanel(
selectInput(inputId = "role",
label = "Choose a role:",
choice = c("Top", "Jungle","Middle", "ADC", "Support",
selected = "Middle")),
uiOutput("firstdropdown"),
uiOutput("seconddropdown")
),
mainPanel(
plotlyOutput("winrateplot")
)
)
),
tabPanel("Sid"),
tabPanel("Sid&Aman"),
tabPanel("Contact us- Mahir"))
)
)
library("shiny")
library("dplyr")
library("plotly")
source("scripts/win-rate-comparison.R")
shinyServer <- function(input, output) {
# All of this is for the win rate tab
output$firstdropdown <- renderUI({
selectizeInput("player1", label = "Choose Player 1:", choices = winrateRole(input$role)$player,
selected = NULL, multiple = FALSE, options = NULL)
})
output$seconddropdown <- renderUI({
all.choices <- winrateRole(input$role)$player
without.player1 <- all.choices[which(all.choices != input$player1)]
selectizeInput("player2", label = "Choose Player 2:", choices = without.player1,
selected = NULL, multiple = FALSE, options = NULL)
})
output$winrateplot <- renderPlotly({
tmp <- winrateRole(input$role)
players <- c(input$player1, input$player2)
tmp <- tmp %>%
filter(player %in% players) %>%
select(Player = player, Blue = winrate.blue, Red = winrate.red)
winrates <- c(tmp$Blue, tmp$Red)
plot_ly(data = tmp, x = ~Player, y = ~Blue, type = 'bar', name = "Blue side") %>%
add_trace(y = ~Red, name = "Red side") %>%
layout(title = paste0(input$player1, " vs ", input$player2, " Winrate Comparison"),
yaxis = list(title = "Winrate"), barmode = 'stack')
})
}
runApp('Desktop/Assignments/info201-finalproject')
library("dplyr")
library("snakecase")
library("plotly")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
getwd()
setwd("~/Desktop/Assignments/info201-finalproject/")
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
library("dplyr")
library("snakecase")
library("plotly")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
library("dplyr")
library("snakecase")
library("plotly")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
library("dplyr")
library("stringr")
library("plotly")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
View(minRateRole("Middle"))
View(winrateRole("Middle"))
runApp()
install.packages("plotly")
install.packages("plotly")
library("dplyr")
library("plotly")
source("scripts/win-rate-comparison.R")
shinyServer <- function(input, output) {
# All of this is for the win rate tab
output$firstdropdown <- renderUI({
selectizeInput("player1", label = "Choose Player 1:", choices = winrateRole(input$role)$player,
selected = NULL, multiple = FALSE, options = NULL)
})
output$seconddropdown <- renderUI({
all.choices <- winrateRole(input$role)$player
without.player1 <- all.choices[which(all.choices != input$player1)]
selectizeInput("player2", label = "Choose Player 2:", choices = without.player1,
selected = NULL, multiple = FALSE, options = NULL)
})
output$winrateplot <- renderPlotly({
tmp <- winrateRole(input$role)
players <- c(input$player1, input$player2)
tmp <- tmp %>%
filter(player %in% players) %>%
select(Player = player, Blue = winrate.blue, Red = winrate.red)
winrates <- c(tmp$Blue, tmp$Red)
plot_ly(data = tmp, x = ~Player, y = ~Blue, type = 'bar', name = "Blue side") %>%
add_trace(y = ~Red, name = "Red side") %>%
layout(title = paste0(input$player1, " vs ", input$player2, " Winrate Comparison"),
yaxis = list(title = "Winrate"), barmode = 'stack')
})
}
library("shiny")
library("shinythemes")
library("plotly")
shinyUI <- fluidPage(title = "League Analysis", theme = shinytheme("spacelab"),
mainPanel(
navbarPage(strong("League of Legends"),
tabPanel("Overview"),
tabPanel("Player Win Rates",
sidebarLayout(
sidebarPanel(
selectInput(inputId = "role",
label = "Choose a role:",
choice = c("Top", "Jungle","Middle", "ADC", "Support",
selected = "Middle")),
uiOutput("firstdropdown"),
uiOutput("seconddropdown")
),
mainPanel(
plotlyOutput("winrateplot")
)
)
),
tabPanel("Sid"),
tabPanel("Sid&Aman"),
tabPanel("Contact us- Mahir"))
)
)
library("dplyr")
library("stringr")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
runApp()
runApp()
runApp()
runApp()
library("dplyr")
library("stringr")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
View(league.data)
runApp()
runApp()
runApp()
runApp()
highest.combined.winrate <- with(winrateRole(input$role), pmax(winrate.blue + winrate.red))
highest.combined.winrate <- with(winrateRole("Middle"), pmax(winrate.blue + winrate.red))
highest.combined.winrate
library("dplyr")
library("stringr")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(players %in% player) %>%
filter_(side == max(get(side)))
return(tmp)
}
View(higherWinrate("Faker", "Bjergsen", "Middle", "blue"))
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(players %in% player) %>%
filter_(side == max(get(side)))
return(tmp)
}
higherWinrate("Faker", "Crown", "Middle", "blue")
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(players %in% player)
return(tmp)
}
higherWinrate("Faker", "Crown", "Middle", "blue")
higherWinrate("Faker", "Crown", "Middle", "blue")
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role)
return(tmp)
}
higherWinrate("Faker", "Crown", "Middle", "blue")
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(player == "Faker")
return(tmp)
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(player == "Faker")
return(tmp)
}
library("dplyr")
library("stringr")
# This data has all player names (lane-wise), and whether the team has won or not.
league.data <- read.csv("data/_LeagueofLegends.csv", stringsAsFactors = FALSE)
# Making everything title case in the dataset so that there are no duplicates based on case.
league.data <- league.data %>%
mutate_if(is.character, funs(str_to_title(.)))
# This function groups the data by the role specified, and calculates the win rate for each player
# both at the blue side and the red side.
winrateRole <- function(role) {
blue.role <- paste0("blue", role)
blue <- league.data %>%
group_by_(blue.role) %>%
summarise(winrate.blue = round((sum(bResult) / n() * 100), digits = 2)) %>%
arrange_(blue.role) %>%
select(player = blue.role, winrate.blue)
red.role <- paste0("red", role)
red <- league.data %>%
group_by_(red.role) %>%
summarise(winrate.red = round((sum(rResult) / n() * 100), digits = 2)) %>%
arrange_(red.role) %>%
select(player = red.role, winrate.red)
return (left_join(blue, red))
}
higherWinrate <- function(player1, player2, role, side) {
side <- paste0("winrate.", side)
players <- c(player1, player2)
tmp <- winrateRole(role) %>%
filter(player == "Faker")
return(tmp)
}
View
